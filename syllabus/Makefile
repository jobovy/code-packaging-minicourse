all: syllabus-codemini.pdf

vc.tex: ../.git/logs/HEAD
	echo "%%% This file is generated by the Makefile." > vc.tex
	git log -1 --date=short --format="format:\\newcommand{\\githash}{%h}\\newcommand{\\gitdate}{%ad}" >> vc.tex

%.pdf: %.tex vc.tex
	pdflatex $<
	pdflatex $<
	pdflatex $<
	- bash -c " ( grep Rerun $*.log && pdflatex $< ) || echo noRerun "
	- bash -c " ( grep Rerun $*.log && pdflatex $< ) || echo noRerun "

.PHONY: clean spotless

clean:
	$(RM) *.log *.aux *.dvi *.out *.bib
	$(RM) vc.tex
	$(RM) *~

spotless: clean
	$(RM) syllabus-codemini.pdf
